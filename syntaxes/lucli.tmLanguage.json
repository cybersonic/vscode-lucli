{
  "scopeName": "source.lucli",
  "patterns": [
    { "include": "#shebang" },
    { "include": "#envDirective" },
    { "include": "#comment" },
    { "include": "#string" },
    { "include": "#variable" },
    { "include": "#lineContinuation" },
    { "include": "#options" },
    { "include": "#numbers" },
    { "include": "#serverSubcommands" },
    { "include": "#modulesSubcommands" },
    { "include": "#firstWord" }
  ],
  "repository": {
    "shebang": {
      "patterns": [
        {
          "name": "comment.line.shebang.lucli",
          "match": "^#!.*$"
        }
      ]
    },
    "envDirective": {
      "patterns": [
        {
          "name": "keyword.control.directive.env.lucli",
          "match": "^\\s*#@(env:[A-Za-z0-9_,!-]+|dev|development|staging|stage|prod|production|test|testing|local|end)\\b.*$",
          "captures": {
            "0": { "name": "meta.preprocessor.env.lucli" }
          }
        }
      ]
    },
    "comment": {
      "patterns": [
        {
          "name": "comment.line.number-sign.lucli",
          "match": "(^[ \t]*)#.*$"
        }
      ]
    },
    "string": {
      "patterns": [
        {
          "name": "string.quoted.double.lucli",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            { "include": "#variable" },
            { "match": "\\\\.", "name": "constant.character.escape.lucli" }
          ]
        },
        {
          "name": "string.quoted.single.lucli",
          "begin": "'",
          "end": "'",
          "patterns": [
            { "match": "\\\\.", "name": "constant.character.escape.lucli" }
          ]
        }
      ]
    },
    "variable": {
      "patterns": [
        {
          "name": "variable.other.secret.lucli",
          "match": "\\$\\{secret:[^}]+\\}"
        },
        {
          "name": "variable.other.env.lucli",
          "match": "\\$\\{ENV_[^}]+\\}"
        },
        {
          "name": "variable.other.placeholder.lucli",
          "match": "\\$\\{[^}]+\\}"
        },
        {
          "name": "variable.other.command-substitution.lucli",
          "match": "\\$\\([^)]+\\)"
        }
      ]
    },
    "lineContinuation": {
      "patterns": [
        {
          "name": "constant.character.escape.line-continuation.lucli",
          "match": "\\\\\\s*$"
        }
      ]
    },
    "options": {
      "patterns": [
        {
          "name": "variable.parameter.option.long.lucli",
          "match": "--[A-Za-z0-9-]+"
        },
        {
          "name": "variable.parameter.option.short.lucli",
          "match": "-[A-Za-z]"
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.lucli",
          "match": "\\b[0-9]+(\\.[0-9]+)*\\b"
        }
      ]
    },
    "serverSubcommands": {
      "patterns": [
        {
          "name": "keyword.control.server.subcommand.lucli",
          "match": "^\\s*(server)\\s+(start|stop|status|list|log|monitor|prune|config|debug)\\b"
        }
      ]
    },
    "modulesSubcommands": {
      "patterns": [
        {
          "name": "keyword.control.modules.subcommand.lucli",
          "match": "^\\s*(modules)\\s+(list|init|run|install)\\b"
        }
      ]
    },
    "firstWord": {
      "patterns": [
        {
          "name": "entity.name.function.command.lucli",
          "match": "^\\s*([A-Za-z][A-Za-z0-9_-]*)"
        }
      ]
    }
  }
}
